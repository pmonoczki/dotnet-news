

var CCE_EditorPrefix,CCE_EditorContainerPrefix,CCE_Editor=null,CCE_TitleID,CCE_ButtonsID,CCE_LicenseID,CCE_SubmitBtnID,CCE_SubmitText,CCE_CancelBtnID,CCE_MessageLabelID,CCE_CurrentAnnotation=-1,CCE_AnnotationToDelete=-1,CCE_OriginalTitle="",CCE_OriginalContent="",CCE_OriginalTags="",CCE_RemoveMouseEffectFunc=null,CCE_IsIE=document.all;function CCE_CancelAnnotation(){CCE_HideEditor(CCE_CurrentAnnotation,CCE_GetControlPrefixes(CCE_CurrentAnnotation).control)}function CCE_CheckCookies(){var cookieParts=document.cookie.split("; "),crumb="";for(var i=0;i<cookieParts.length;i++){var crumbs=cookieParts[i].split("=");if(crumbs[0]=="wbi"&&crumbs[1]!=""){document.cookie="wbi=; expires=Fri, 02-Jan-1970 00:00:00 GMT";var crumbParts=crumbs[1].split(":");if(crumbParts[0]=="edit"&&crumbParts[1]!="")CCE_EditAnnotation(crumbParts[1])}}}function CCE_DeleteAnnotation(idx){if(idx<0)return;CCE_InitEditor();if(confirm(CCI_DeleteConfirmationText)){CCE_AnnotationToDelete=idx;var deleteBtn=$get(CCE_GetControlPrefixes(CCE_AnnotationToDelete).container+"Delete");deleteBtn.disabled=true;Microsoft.Mtps.Web.WebServices.CCWebService.DeleteAnnotation(CCS_User,CCS_ContentUrl,CCE_AnnotationToDelete,CCE_DeleteAnnotationComplete,CCE_DeleteAnnotationFailure)}}function CCE_DeleteAnnotationComplete(result){var annotationElem=$get(CCE_GetControlPrefixes(CCE_AnnotationToDelete).container+"Container");annotationElem.style.display="none";CCE_AnnotationToDelete=-1}function CCE_DeleteAnnotationFailure(error){var deleteBtn=$get(CCE_GetControlPrefixes(CCE_AnnotationToDelete).container+"Delete");deleteBtn.disabled=false;CCE_ShowError(deleteBtn,error.get_message());CCE_AnnotationToDelete=-1}function CCE_EditAnnotation(idx){if(CCE_IsEditing)return;CCE_InitEditor();CCE_Editor.tooltip.hide();CCE_SubmitText=$get(CCE_SubmitBtnID).value;CCE_CurrentAnnotation=idx;if(idx!=-1){var prefixes=CCE_GetControlPrefixes(idx),annotationPrefix=prefixes.control,annotationContainerPrefix=prefixes.container,annotationElem=$get(annotationPrefix+"RadEditor"),annotationContainer=$get(annotationContainerPrefix+"EditorPanel"),bounds=Sys.UI.DomElement.getBounds(annotationElem);CCE_Editor.instance.setSize(bounds.width,Math.max(200,bounds.height));CCE_OriginalTitle=$get(annotationContainerPrefix+"HeaderTitle").innerHTML;CCE_OriginalContent=$get(annotationPrefix+"editorData").value;CCE_OriginalTags=$get(annotationPrefix+"tagEditorData").value;annotationElem.style.display="none";$get(annotationContainerPrefix+"Header").style.display="none";var historyElem=$get(annotationContainerPrefix+"HistoryContent");if(historyElem)historyElem.style.display="none";$get(annotationContainerPrefix+"TagEditor_panel").style.display="none";annotationContainer.className="CCI_Text_Edit";var annotationPanelID=annotationContainerPrefix+"Container";CCE_RemoveMouseEffectFunc=function(){CCI_Highlight(false,annotationPanelID)};var annotationPanelElem=$get(annotationPanelID);$addHandler(annotationPanelElem,"mouseover",CCE_RemoveMouseEffectFunc);annotationPanelElem.className="CCI_Container_Edit"}else{CCE_OriginalTitle="";CCE_OriginalContent="";CCE_OriginalTags=""}CCE_Editor.containerElement.style.display="";var titleElem=$get(CCE_TitleID);titleElem.value=CCE_OriginalTitle;CCE_SetEditorContent(CCE_OriginalContent);if(idx!=-1)annotationContainer.insertBefore(CCE_Editor.element,null);$get(CCE_EditorPrefix+"tagEditorTextBox").value=CCE_OriginalTags;$get(CCE_MessageLabelID).style.display="none";titleElem.style.display="";$get(CCE_ButtonsID).style.display="";$get(CCE_LicenseID).style.display="";CCE_Editor.containerElement.scrollIntoView(true);titleElem.focus();$get(CCS_AddLinkID).className="CCS_AddLinkDisabled";CCE_IsEditing=true}function CCE_GetChildElementByID(elem,id){var childCount=elem.childNodes.length;for(var i=0;i<childCount;i++){var childElem=elem.childNodes[i];if(childElem.id==id)return childElem;if(childElem.childNodes.length>0){var result=CCE_GetChildElementByID(childElem,id);if(result)return result}}return null}function CCE_GetControl(idx,name){return $get(CCE_GetControlPrefixes(idx).control+name)}function CCE_GetControlPrefixes(idx){var count=CCE_EditorInfo.length;for(var i=0;i<count;i++){var value=CCE_EditorInfo[i];if(value["i"]==idx)return {control:value["p"],container:value["c"]}}}function CCE_HideEditor(idx,annotationPrefix){if(idx!=-1){var annotationContainerPrefix=CCE_GetControlPrefixes(idx).container,annotationElem=$get(annotationPrefix+"RadEditor");CCE_Editor.containerElement.insertBefore(CCE_Editor.element,null);annotationElem.style.display="";$get(annotationContainerPrefix+"Header").style.display="";var historyElem=$get(annotationContainerPrefix+"HistoryContent");if(historyElem)historyElem.style.display="none";$get(annotationContainerPrefix+"TagEditor_panel").style.display="";var annotationContainer=$get(annotationContainerPrefix+"EditorPanel");annotationContainer.className="CCI_Text";var annotationPanelID=annotationContainerPrefix+"Container",annotationPanelElem=$get(annotationPanelID);$removeHandler(annotationPanelElem,"mouseover",CCE_RemoveMouseEffectFunc);CCE_RemoveMouseEffectFunc=null;annotationPanelElem.className="CCI_Container"}CCE_Editor.containerElement.style.display="none";$get(CCE_TitleID).style.display="none";$get(CCE_ButtonsID).style.display="none";$get(CCE_LicenseID).style.display="none";$get(CCS_AddLinkID).className="CCS_AddLink";CCE_Editor.tooltip.hide();CCE_IsEditing=false;CCE_CurrentAnnotation=-1}function CCE_Init(){var prefixes=CCE_GetControlPrefixes(-1);CCE_EditorPrefix=prefixes.control;CCE_EditorContainerPrefix=prefixes.container;CCE_TitleID=CCE_EditorPrefix+"title";CCE_ButtonsID=CCE_EditorPrefix+"panButtons";CCE_LicenseID=CCE_EditorPrefix+"licensePanel";CCE_SubmitBtnID=CCE_EditorPrefix+"Save";CCE_CancelBtnID=CCE_EditorPrefix+"Cancel";CCE_MessageLabelID=CCE_EditorPrefix+"lblMessage";window.setTimeout(CCE_CheckCookies,400)}function CCE_InitEditor(){if(CCE_Editor==null){CCE_Editor={instance:$find(CCE_EditorPrefix+"RadEditor"),tooltip:$find(CCE_EditorPrefix+"RadTooltip"),element:$get(CCE_EditorPrefix+"Container"),containerElement:$get(CCE_EditorContainerPrefix+"EditorPanel"),contentElement:$get(CCE_EditorPrefix+"RadEditorCenter")};$addHandler($get(CCE_TitleID),"keydown",function(e){if(e.keyCode==9&&e.shiftKey==false){var de=new Sys.UI.DomEvent(e);de.preventDefault();de.stopPropagation();CCE_Editor.instance.setFocus()}});$addHandler(CCE_Editor,"click",function(){CCE_Editor.instance.setFocus()})}}function CCE_OnClientCmdExecuted(sender,args){var cmdName=args.get_commandName();if(cmdName=="FormatBlock"){var val=args.get_value(),selElem=sender.getSelectedElement();if(val=="<body>"){if(selElem.tagName=="P"){selElem.removeAttribute("className");selElem.removeAttribute("class")}}else if(val.toLowerCase().indexOf("<pre")>-1){var doc=sender.get_document(),isIE=sender.isIE,pres=doc.getElementsByTagName("PRE");for(var i=0;i<pres.length;i++){var pre=pres[i];if(!isIE){if(pre.previousSibling){var br=pre.previousSibling.previousSibling;if(br&&br.tagName=="BR")br.parentNode.removeChild(br)}if(pre.nextSibling){var br=pre.nextSibling.nextSibling;if(br&&br.tagName=="BR")br.parentNode.removeChild(br)}var textNode=pre.firstChild;if(textNode&&textNode.nodeType==3&&textNode.nodeValue.startsWith("\n")){var newText=doc.createTextNode(textNode.nodeValue.trim());textNode.parentNode.replaceChild(newText,textNode)}}}}}}function OnClientCommandExecuting(editor,args){var commandName=args.get_commandName();if(commandName==="Outdent"&&typeof args._tool!="undefined"){args.set_cancel(true);editor.fire("Indent")}if(commandName==="Indent"&&typeof args._tool!="undefined"){args.set_cancel(true);editor.fire("Outdent")}}function CCE_OnClientLoad(sender,args){var editor_element=sender.get_element(),tableID=editor_element.id+"Wrapper",rows=$get(tableID).rows;rows[0].style.display="none";rows[3].style.display="none";rows[4].style.display="none";rows[5].style.display="none";var body=document.all?sender.get_document().body:sender.get_document();$telerik.addExternalHandler(body,"keydown",function(e){if(e.keyCode==9&&e.shiftKey==true){var de=new Sys.UI.DomEvent(e);de.preventDefault();de.stopPropagation();window.setTimeout(function(){$get(CCE_TitleID).focus()},0)}})}function CCE_SaveAnnotation(){var titleElem=$get(CCE_TitleID),title=titleElem.value,content=CCE_Editor.instance.get_html(false),tags=$get(CCE_EditorPrefix+"tagEditorTextBox").value;if(title.trim().length==0){CCE_ShowError(titleElem,CCE_ErrEmptyTitle);return}if(title.length>CCE_TitleMaxLen){CCE_ShowError(titleElem,CCE_ErrTitleTooLong);return}if(content.trim().length==0||CCE_Editor.instance.get_text().trim().length==0){CCE_ShowError(CCE_Editor.contentElement,CCE_ErrEmptyContent);return}if(content.length>CCE_ContentMaxLen){CCE_ShowError(CCE_Editor.contentElement.body,CCE_ErrContentTooLong);return}if((content.trim()==CCE_OriginalContent.trim()||CCE_Editor.instance.get_html(true).trim()==CCE_OriginalContent.trim())&&title.trim()==CCE_OriginalTitle.trim()&&tags.trim()==CCE_OriginalTags.trim()){CCE_ShowError(CCE_Editor.contentElement,CCE_ErrSameContent);return}var submitBtn=$get(CCE_SubmitBtnID);submitBtn.disabled=true;submitBtn.value=CCE_UpdateText+"...";$get(CCE_CancelBtnID).style.display="none";Microsoft.Mtps.Web.WebServices.CCWebService.UpdateAnnotation(CCS_User,CCS_ContentUrl,CCE_CurrentAnnotation,content,title,tags,CCT_Browse,CCT_Remove,CCE_UpdateAnnotationComplete,CCE_UpdateAnnotationFailure)}function CCE_SetHtml(target,content){if(target){var elem=document.createElement("div");if(content)elem.innerHTML=content;elem.style.display="inline";target.innerHTML="";target.appendChild(elem)}}function CCE_SetEditorContent(content){CCE_Editor.instance.set_html(content);var manager=CCE_Editor.instance.get_commandsManager();manager._clearCommandsToRedo();var length=manager.getCommandsToUndo().length;for(var i=0;i<length;i++)manager.removeCommandAt(0)}function CCE_ShowError(target,text){CCE_Editor.tooltip.set_text(text);CCE_Editor.tooltip.set_targetControl(target);window.setTimeout(function(){CCE_Editor.tooltip.show()},10)}function CCE_UpdateAnnotationComplete(result){if(CCE_CurrentAnnotation!=-1){var prefixes=CCE_GetControlPrefixes(CCE_CurrentAnnotation),annotationPrefix=prefixes.control,annotationContainerPrefix=prefixes.container,annotationElem=$get(annotationPrefix+"RadEditor");$get(annotationContainerPrefix+"HeaderTitle").innerHTML=result.Title;CCE_SetHtml(annotationElem,result.Content);$get(annotationPrefix+"editorData").value=result.Content;if(result.Tags!=null)$get(annotationPrefix+"tagEditorData").value=result.Tags;var tagEditorBody=$get(annotationContainerPrefix+"TagEditor_tags");CCE_SetHtml(tagEditorBody,result.TagsHtml)}else{var prefixes=CCE_GetControlPrefixes(-2),templateContainerPrefix=prefixes.container,templatePrefix=prefixes.control,newContainerPrefix=CCE_EditorContainerPrefix+CCE_EditorInfo.length+"_",newPrefix=CCE_EditorPrefix+CCE_EditorInfo.length+"_",newAnnotation=$get(templateContainerPrefix+"Container").cloneNode(true);newAnnotation.style.display="";var newHeaderElem=CCE_GetChildElementByID(newAnnotation,templateContainerPrefix+"Header"),newEditorElem=CCE_GetChildElementByID(newAnnotation,templateContainerPrefix+"EditorPanel"),newTagEditorElem=CCE_GetChildElementByID(newAnnotation,templateContainerPrefix+"TagEditor_panel");newAnnotation.id=newContainerPrefix+"Container";newHeaderElem.id=newContainerPrefix+"Header";newEditorElem.id=newContainerPrefix+"EditorPanel";CCE_GetChildElementByID(newEditorElem,templatePrefix+"Container").id=newPrefix+"Container";newTagEditorElem.id=newContainerPrefix+"TagEditor_panel";newTagEditorElem.className="CCT_Panel_Block";var titleElem=CCE_GetChildElementByID(newHeaderElem,templateContainerPrefix+"HeaderTitle");titleElem.id=newContainerPrefix+"HeaderTitle";titleElem.innerHTML=result.Title;var contentElem=CCE_GetChildElementByID(newEditorElem,templatePrefix+"RadEditor");CCE_SetHtml(contentElem,result.Content);contentElem.id=newPrefix+"RadEditor";contentElem.title="";var dataElem=CCE_GetChildElementByID(newAnnotation,templatePrefix+"editorData");dataElem.id=newPrefix+"editorData";dataElem.value=result.Content;var tagsElem=CCE_GetChildElementByID(newTagEditorElem,templateContainerPrefix+"TagEditor_tags");CCE_SetHtml(tagsElem,result.TagsHtml);var tagsDataElem=CCE_GetChildElementByID(newAnnotation,templatePrefix+"tagEditorData");tagsDataElem.id=newPrefix+"tagEditorData";if(result.Tags)tagsDataElem.value=result.Tags;var existinguser=$get(CCE_EditorContainerPrefix+"lnkViewProfile");if(existinguser!=null){var userLink=existinguser.cloneNode(true);userLink.className="CCI_Header_Link";var newEditInfo=CCE_GetChildElementByID(newHeaderElem,templateContainerPrefix+"EditInfo");newEditInfo.appendChild(userLink)}var editElem=CCE_GetChildElementByID(newHeaderElem,templateContainerPrefix+"Edit");$addHandler(editElem,"click",function(e){CCE_EditAnnotation(result.Index);e.stopPropagation();e.preventDefault()});$addHandler(contentElem,"dblclick",function(e){CCE_EditAnnotation(result.Index);e.stopPropagation();e.preventDefault()});CCE_GetChildElementByID(newTagEditorElem,templateContainerPrefix+"TagEditor_addTagLink").style.display="none";$get(CCE_EditorContainerPrefix+"wikiItems").appendChild(newAnnotation);CCE_EditorInfo[CCE_EditorInfo.length]={i:result.Index,p:newPrefix,c:newContainerPrefix}}CCE_HideEditor(CCE_CurrentAnnotation,CCE_GetControlPrefixes(CCE_CurrentAnnotation).control);var submitBtn=$get(CCE_SubmitBtnID);submitBtn.value=CCE_SubmitText;submitBtn.disabled=false;$get(CCE_CancelBtnID).style.display=""}function CCE_UpdateAnnotationFailure(error){var submitBtn=$get(CCE_SubmitBtnID);CCE_ShowError(submitBtn,CCE_ErrServerError);submitBtn.value=CCE_SubmitText;submitBtn.disabled=false;$get(CCE_CancelBtnID).style.display=""}function licTooltipClientShow(sender,eventArgs){var licTooltipId="RadToolTipWrapper_"+Telerik.Web.UI.RadToolTip.getCurrent()._element.id;if($get(licTooltipId).offsetLeft<0)$get(licTooltipId).style.left="0px";if(jQuery.browser.mozilla)$get(licTooltipId).style.top=$get(CCE_GetControlPrefixes(-1).control+"licensePreText").offsetTop-$get(licTooltipId).offsetHeight-16+"px"}function ErrorTooltipClientShow(sender,eventArgs){var errorTooltipId="RadToolTipWrapper_"+CCE_Editor.tooltip._element.id;if($get(errorTooltipId).offsetLeft<0)$get(errorTooltipId).style.left=CCE_Editor.element.offsetWidth/2+"px"}



var _ccs_controlId="",_ccs_containerId="",_timer;function CCS_BeginRequestHandler(sender,args){var prm=Sys.WebForms.PageRequestManager.getInstance();_ccs_controlId=args.get_postBackElement().id;if(prm.get_isInAsyncPostBack())args.set_cancel(true);var idx=_ccs_controlId.lastIndexOf("_");_ccs_containerId=_ccs_controlId.substring(0,idx+1)+"Container";var container=$get(_ccs_containerId);if(container);}function CCS_EndRequestHandler(sender,args){var prm=Sys.WebForms.PageRequestManager.getInstance();_ccs_controlId="";_ccs_containerId=""}function CCS_Scroll(){var tooltip=Telerik.Web.UI.RadToolTip.getCurrent();if(tooltip&&tooltip.isVisible())tooltip.show()}function CCS_ShowHelp(path,width,height){var top=window.screen.height/2-height/2,left=window.screen.width/2-width/2;window.open(path,"_blank","height="+height+",width="+width+",top="+top+",left="+left+",location=no,menubar=no,resizable=yes,status=no,toolbar=no,scrollbars=yes")}



var _currentannotationIndex=0,_flaggingContentBug=false,_unflaggingContentBug=false,_originatingUrl;function CCT_AddATag(url,annotationIndex){if(url!=""){document.cookie="edit="+annotationIndex;document.cookie="scroll="+annotationIndex;document.location.href=url}else{CCT_ShowTagEditorEditPanel(annotationIndex);CCT_GetControl(annotationIndex,"textbox").focus()}return false}function CCT_AddTags(annotationIndex){var value=CCT_GetControl(annotationIndex,"textbox").value;if(value!=""){_currentannotationIndex=annotationIndex;Microsoft.Mtps.Web.WebServices.CCWebService.AddTags(CCS_User,_originatingUrl,value,annotationIndex,CCT_Browse,CCT_Remove,CCT_TagEditorChangeComplete,CCT_TagEditorChangeFailure);CCT_ShowTagEditorViewPanel(annotationIndex)}else CCT_GetControl(annotationIndex,"messagePanel").innerHTML=CCT_NoTags;return false}function CCT_BrowseTag(url,annotationIndex){document.cookie="scroll="+annotationIndex;document.location.href=url;return false}function CCT_CancelAddTag(annotationIndex){CCT_ShowTagEditorViewPanel(annotationIndex);return false}function CCT_FlagContentBug(url,annotationIndex){if(url!=""){document.cookie="contentbug="+annotationIndex;document.cookie="scroll="+annotationIndex;document.location.href=url}else{_currentannotationIndex=annotationIndex;_flaggingContentBug=true;Microsoft.Mtps.Web.WebServices.CCWebService.AddTags(CCS_User,_originatingUrl,CCT_BugTag,annotationIndex,CCT_Browse,CCT_Remove,CCT_TagEditorChangeComplete,CCT_TagEditorChangeFailure)}return false}function CCT_GetAnnotationIndex(controlID){var count=CCT_Controls.length;for(var i=0;i<count;i++){var value=CCT_Controls[i],idx=controlID.indexOf(value["prefix"]);if(idx!=-1)return value["id"]}return -1}function CCT_GetControl(annotationIndex,control){var count=CCT_Controls.length;for(var i=0;i<count;i++){var value=CCT_Controls[i];if(value["id"]==annotationIndex)return $get(value["prefix"]+control)}}function CCT_GetTags(annotationIndex){var tags="",tagEditorBody=CCT_GetControl(annotationIndex,"tags");if(tagEditorBody){var childElems=tagEditorBody.children;if(childElems.length>0){if(childElems[0].tagName=="DIV")childElems=childElems[0].children;if(childElems.length>0)for(var i=0;i<childElems.length;i++){var elem=childElems[i].children[0];if(elem.tagName=="A")tags+=elem.innerHTML+" "}}}return tags}function CCT_Init(auth,originatingUrl){_originatingUrl=originatingUrl;var cookieParts=document.cookie.split("; "),crumb="";for(var i=0;i<cookieParts.length;i++){var crumbs=cookieParts[i].split("=");if(crumbs[0]=="scroll"&&crumbs[1]!="")CCT_ScrollToTagEditor(crumbs[1]);if(crumbs[0]=="edit"&&crumbs[1]!=""&&auth=="true")CCT_ShowTagEditorEditPanel(crumbs[1])}CCT_RemoveTagEditorCookie("remove");CCT_RemoveTagEditorCookie("contentbug")}function CCT_KeyDown(evt){if(evt.keyCode==13){CCT_AddTags(CCT_GetAnnotationIndex(evt.target.id));evt.preventDefault()}else if(evt.keyCode==27){CCT_CancelAddTag(CCT_GetAnnotationIndex(evt.target.id));evt.preventDefault()}else return true}function CCT_RemoveTag(tag,url,annotationIndex){if(url!=""){document.cookie="remove="+tag+":"+annotationIndex;document.cookie="scroll="+annotationIndex;document.location.href=url}else{_currentannotationIndex=annotationIndex;if(tag==CCT_BugTag)_unflaggingContentBug=true;Microsoft.Mtps.Web.WebServices.CCWebService.RemoveTag(CCS_User,_originatingUrl,tag,annotationIndex,CCT_Browse,CCT_Remove,CCT_TagEditorChangeComplete,CCT_TagEditorChangeFailure)}return false}function CCT_RemoveTagEditorCookie(name){document.cookie=name+"=; expires=Fri, 02-Jan-1970 00:00:00 GMT"}function CCT_ScrollToTagEditor(annotationIndex){var ctrl=CCT_GetControl(annotationIndex,"textbox");if(ctrl)ctrl.scrollIntoView(false);CCT_RemoveTagEditorCookie("scroll")}function CCT_ShowTagEditorEditPanel(annotationIndex){CCT_GetControl(annotationIndex,"view").style.display="none";CCT_GetControl(annotationIndex,"editPanel").style.display="";CCT_GetControl(annotationIndex,"textbox").value="";CCT_GetControl(annotationIndex,"messagePanel").innerHTML="";CCT_RemoveTagEditorCookie("edit")}function CCT_ShowTagEditorViewPanel(annotationIndex){CCT_GetControl(annotationIndex,"view").style.display="";CCT_GetControl(annotationIndex,"editPanel").style.display="none";CCT_GetControl(annotationIndex,"messagePanel").innerHTML=""}function CCT_TagEditorChangeComplete(result){var elem=document.createElement("div");elem.innerHTML=result;elem.style.display="inline";var tagEditorBody=CCT_GetControl(_currentannotationIndex,"tags");if(tagEditorBody){tagEditorBody.innerHTML="";tagEditorBody.appendChild(elem)}if(_flaggingContentBug){_flaggingContentBug=false;var flagPanel=CCT_GetControl(_currentannotationIndex,"flagAsPanel");if(flagPanel)flagPanel.style.display="none"}if(_unflaggingContentBug){_unflaggingContentBug=false;var flagPanel=CCT_GetControl(_currentannotationIndex,"flagAsPanel");if(flagPanel)flagPanel.style.display="block"}_currentannotationIndex=0}function CCT_TagEditorChangeFailure(error){CCT_GetControl(_currentannotationIndex,"messagePanel").innerHTML=CCT_Error;CCT_GetControl(_currentannotationIndex,"messagePanel").title=error.get_message();if(_flaggingContentBug)_flaggingContentBug=false;if(_unflaggingContentBug)_unflaggingContentBug=false}function CCTagResizableAreaChange(isCollapsing){resizeTagWidth()}function resizeTagWidth(){if(jQuery(".resizableArea .leftSection").length>0&&jQuery(".CCT_Panel").length>0&&jQuery.browser.msie&&jQuery.browser.version=="7.0"&&document.body.dir=="rtl")if(jQuery(".resizableArea .leftSection")[0].style.display=="none")jQuery(".CCT_Panel")[0].style.width=jQuery(".CCS_TopicTagEditor")[0].offsetWidth-10+"px";else jQuery(".CCT_Panel")[0].style.width=""}jQuery(document).ready(function(){if(jQuery(".resizableArea .leftSection").length>0&&jQuery(".CCT_Panel").length>0&&jQuery.browser.msie&&jQuery.browser.version=="7.0"&&document.body.dir=="rtl")resizeTagWidth()})



function IsPageRated(objID,labelID,text,flyoutID,btn){obj=document.getElementById(objID);if(obj.Rated){SubmitRating(RatingObjId,sendBtnId,pageTag);window.onbeforeunload=function(){if(window.onbeforeunload_autosubmit)window.onbeforeunload_autosubmit()};flyout=document.getElementById(flyoutID);TFly_Popup(flyout,false);window.setTimeout(function(){btn.disabled=true},100);contentRated=true;obj.Rated=true;var idePrefix=objID.replace("Rating1",""),rtgContainer=document.getElementById(idePrefix+"rtgContainer");obj.title=RatedTooltipText;if(rtgContainer!=null)rtgContainer.title=RatedTooltipText;var mini_rightDivId=document.getElementById(flyoutID).parentNode.id;jQuery("#"+idePrefix+"rtgContainer").appendTo("#"+mini_rightDivId);flyout.style.display="none";for(var i=1;i<=maxRating;i++){var star=document.getElementById(objID+"_Star_"+i);if(star!=null)star.title=RatedTooltipText}return true}else{label=document.getElementById(labelID);if(label.timer)window.clearTimeout(label.timer);else{label.className_=label.className;label.innerHTML_=label.innerHTML;label.className="WarningMessage";label.innerHTML=text}label.timer=window.setTimeout(function(){label.className=label.className_;label.innerHTML=label.innerHTML_;label.timer=null},3000)}return false}function GetRating(){var i=1;while(i<=maxRating){var obj;if(MtpsPageDirection=="rtl")obj=document.getElementById(RatingObjId+"_Star_"+(maxRating+1-i));else obj=document.getElementById(RatingObjId+"_Star_"+i);if(obj!=null&&obj.className.indexOf("emptyRatingStar")!=-1)break;i++}return i-1}function getComment(){var obj=document.getElementById(tbCommentsId);if(obj!=null)if(typeof obj.value!="undefined")return escapeHTML(obj.value);else return ""}function escapeHTML(str){var div=document.createElement("div"),text=document.createTextNode(str);div.appendChild(text);return div.innerHTML}function tbNavParent(navUrl){window.top.location.href=navUrl}function SubmitRating(objName,btnName,tag){try{var params="{";params+='"guestId":"'+CurUserId+'"';params+=',"contentUrl":"'+ClientURL+'"';params+=',"device":"'+Rating_Device+'"';params+=',"userIPAddress":"'+userIPAddress+'"';params+=',"userRating":"'+GetRating()+'"';params+=',"userComments":"'+getComment()+'"';params+=',"logException":"'+MTPS.Controls.MtpsRating.EnableLogException+'"';params+="}";jQuery.ajax({type:"POST",url:"/Platform/Controls/InteractiveToolbar/RatingsWebService.asmx/RateTopic",data:params,contentType:"application/json; charset=utf-8",dataType:"json",async:false,success:function(msg){},error:function(response){if(MTPS.Controls.MtpsRating.EnableLogException)LogRateClientException(response.responseText)}});contentRated=true;MTPS.Controls.MtpsRating.ConvertWaitingToFilled();var obj=$get(objName),btn=document.getElementById(btnName);if(obj&&obj.Rated&&btn){var d=new Date;d.setFullYear(d.getFullYear()+1);var CookieInfo=tag+"="+escape("xxx")+";expires="+d.toGMTString()+" path=/;";document.cookie=CookieInfo}}catch(e){if(MTPS.Controls.MtpsRating.EnableLogException)LogRateClientException(e.message)}}function LogRateClientException(errorMsg){var params="{";params+='"contentUrl":"'+ClientURL+'"';params+=',"userAgent":"'+navigator.userAgent+'"';params+=',"errorMsg":"'+errorMsg+'"';params+=',"userIPAddress":"'+userIPAddress+'"';params+="}";jQuery.ajax({type:"POST",url:"/Platform/Controls/InteractiveToolbar/RatingsWebService.asmx/LogRateClientException",data:params,contentType:"application/json; charset=utf-8",dataType:"json",success:function(msg){}})}function RegisterAutoSubmit(objName,btnName,tag){window.onbeforeunload_autosubmit=window.onbeforeunload;window.onbeforeunload=function(){if(window.onbeforeunload_autosubmit)window.onbeforeunload_autosubmit();obj=document.getElementById(objName);if(obj.Rated&&!contentRated)SubmitRating(objName,btnName,tag)}}function SubmitRateAction(eventArgument){try{var params="{";params+='"guestId":"'+CurUserId+'"';params+=',"contentUrl":"'+ClientURL+'"';params+=',"userIPAddress":"'+userIPAddress+'"';params+=',"eventArgument":"'+eventArgument+'"';params+="}";jQuery.ajax({type:"POST",url:"/Platform/Controls/InteractiveToolbar/RatingsWebService.asmx/RateAction",data:params,contentType:"application/json; charset=utf-8",dataType:"json",success:function(msg){}})}catch(e){}}function TFlyPreAnimate(TFly){TFly.status="on"}function CloseFLY(flyoutID){var TFly1=$get(flyoutID);TFly_SetVisibility(TFly1,false);document.body.focus()}



if(typeof MTPS=="undefined"||!MTPS)var MTPS={};if(typeof MTPS.Controls=="undefined"||!MTPS.Controls)MTPS.Controls={};if(typeof MTPS.Controls.MtpsRating=="undefined"||!MTPS.Controls.MtpsRating)MTPS.Controls.MtpsRating={};MTPS.Controls.MtpsRating.createMtpsRating=function(id,_starCssClass,_filledStarCssClass,_emptyStarCssClass,_waitingStarCssClass,_maxRating,_direction,_enableLogException){this.MtpsRatingSelector="#"+id;this.MtpsRating=jQuery(this.MtpsRatingSelector);this.starCssClass=_starCssClass;this.filledStarCssClass=_filledStarCssClass;this.emptyStarCssClass=_emptyStarCssClass;this.waitingStarCssClass=_waitingStarCssClass;this.readOnly=false;this.maxRatingValue=5;this.currentRating=curRating;this.keyboardEditing=false;this.tag="";this.stars=[];this.Rated=contentRated;this.EnableLogException=_enableLogException;if(this.Rated){id=id.replace("_Flyout","");document.getElementById(id+"_A").title=RatedTooltipText;this.readOnly=true}else document.getElementById(id+"_A").title=RatingTooltipText;document.getElementById(id).Rated=this.Rated;if(_direction.toLowerCase().indexOf("lefttoright")!=-1)this.ratingDirection=0;else this.ratingDirection=1;jQuery(this.MtpsRatingSelector+" a").bind("onmouseout",function(e){MTPS.Controls.MtpsRating.mouseOutHandler()});jQuery(this.MtpsRatingSelector+" span").each(function(i){if(MTPS.Controls.MtpsRating.ratingDirection==0)jQuery(this).attr("value",i+1);else jQuery(this).attr("value",MTPS.Controls.MtpsRating.maxRatingValue-i);jQuery(this).attr("title",jQuery(MTPS.Controls.MtpsRating.MtpsRatingSelector+" a").attr("title"));var v=jQuery(this).attr("value");jQuery(this).bind("mouseover",function(e){MTPS.Controls.MtpsRating.starMouseOverHandler(v)});jQuery(this).bind("click",function(e){MTPS.Controls.MtpsRating.starClickHandler(v)});Array.add(MTPS.Controls.MtpsRating.stars,this)});this.starClickHandler=function(value){if(this.readOnly||contentRated)return;var flyout=document.getElementById(RatingFlyoutID);if(flyout!=null){flyout.status=null;flyout.onPreAnimate=null;TFly_Popup(flyout,true)}this.set_Rating(value)};this.starMouseOverHandler=function(value){if(this.readOnly||this.Rated)return;this.UpdateStarCSS(value,this.filledStarCssClass)};this.mouseOutHandler=function(){if(this.readOnly||this.Rated)return;this.UpdateStarCSS(this.currentRating,this.filledStarCssClass)};this.ConvertWaitingToFilled=function(){jQuery("."+this.waitingStarCssClass).removeClass(this.waitingStarCssClass).addClass(this.filledStarCssClass)};this.UpdateStarCSS=function(value,updateStarCSS){jQuery(".ratingStar").removeClass(this.filledStarCssClass).removeClass(this.UpdateStarCSS).removeClass(this.waitingStarCssClass);for(var i=0;i<this.maxRatingValue;i++){var starElement;if(this.ratingDirection==0)starElement=this.stars[i];else starElement=this.stars[this.maxRatingValue-i-1];if(value>i)starElement.className=this.starCssClass+" "+updateStarCSS;else starElement.className=this.starCssClass+" "+this.emptyStarCssClass}};this.set_Rating=function(value){if(this.readOnly)return;this.UpdateStarCSS(value,this.waitingStarCssClass);this.Rated=true;document.getElementById(id).Rated=this.Rated};this.OnKeyPress=function(e){if(e.target.tagName.toLowerCase()=="input"||e.target.tagName.toLowerCase()=="textarea"||contentRated)return;if(e.which==9)if(!e.data.keyboardEditing){document.getElementById(id).focus();e.data.keyboardEditing=true}else{e.data.keyboardEditing=false;var commentid=jQuery("div[class='ratingFlyoutPopup'] textarea").attr("id")}if(e.which==37&&e.data.currentRating>1&&e.data.keyboardEditing){e.data.currentRating--;e.data.starClickHandler(e.data.currentRating)}if(e.which==39&&e.data.currentRating<5&&e.data.keyboardEditing){e.data.currentRating++;e.data.starClickHandler(e.data.currentRating)}e.cancelBubble=true};jQuery(this.MtpsRatingSelector).bind("keydown",this,this.OnKeyPress)}



function jsTrim(s){return s.replace(/(^\s+)|(\s+$)/g,"")}function Track(trackParm,objLink){var daysToExpire=60,cookieDate=new Date;cookieDate.setTime(cookieDate.getTime()+daysToExpire*24*2160000000);expires="expires="+cookieDate.toGMTString();if(typeof pageShortId!=="undefined"&&objLink.hash)document.cookie="InstrumentedLinkAnchorHashCookie="+pageShortId+":"+objLink.hash.replace("#","")+"; "+expires;if(objLink.innerText&&jsTrim(objLink.innerText))LinkText=objLink.innerText;else if(objLink.all&&objLink.all(0).alt)LinkText=objLink.all(0).alt;var strDomain=document.domain,s=trackParm.split("|"),strLinkArea,strLinkId,strPageRegion;if(trackParm.substring(0,1)=="|"){strPageRegion=s[1];strLinkArea=s[2];strLinkId=s[2]+s[3]}else{strLinkArea=s[0];strLinkId=s[0]+s[1]}if(typeof LinkText=="undefined"||!LinkText||LinkText=="")LinkText=strLinkId;ctUrl=objLink.href+"?LinkId="+strLinkId+"&LinkArea="+strLinkArea;if(typeof DCSext!="undefined"){DCSext.wt_strHeadlnLocale=detectedLocale;DCSext.wt_strCat=strLinkArea+"|"+detectedLocale;DCSext.wt_strUrl=window.location.href.toLowerCase();DCSext.wt_strArea=strPageRegion}return false}



function FlyoutPopupShow(){jQuery(".LocaleManagementFlyoutPopup").toggle()}function FlyoutPopupHide(){if(jQuery(".LocaleManagementFlyoutPopup").css("display")=="block")jQuery(".LocaleManagementFlyoutPopup").toggle()}



var MtpsLoginStatus={};MtpsLoginStatus.SignInHappened=0;MtpsLoginStatus.LoginWindowHandle=0;MtpsLoginStatus.OverlayImagePath="/Platform/Controls/StoMtpsLoginStatus/resources/veil.gif";MtpsLoginStatus.DoPassportSignIn=function(url){if(MtpsLoginStatus.SignInHappened<1){var e=(screen.availWidth-850)*.5,f=(screen.availHeight-450)*.5,d="channelmode=0,directories=0,fullscreen=0,location=1,menubar=0,resizable=0,scrollbars=1,status=0,titlebar=0,toolbar=0,copyhistory=0,statusbar=0";MtpsLoginStatus.LoginWindowHandle=MtpsLoginStatus.OpenNewWindow(url,"_blank",d,900,500,e,f);MtpsLoginStatus.LoginWindowHandle.focus();MtpsLoginStatus.SignInHappened++;MtpsLoginStatus.ExpandOrCollapse("idPPMWOverlay");setTimeout("MtpsLoginStatus.CheckOnPassportSignIn()",100);return false}else return true};MtpsLoginStatus.CheckOnPassportSignIn=function(){if(MtpsLoginStatus.LoginWindowHandle.closed)MtpsLoginStatus.ExpandOrCollapse("idPPMWOverlay");else setTimeout("MtpsLoginStatus.CheckOnPassportSignIn()",100)};MtpsLoginStatus.OpenNewWindow=function(m,j,d,f,e,a,b){var g="toolbar, location, directories, status, menubar, scrollbars, resizable",i="width="+(f>0?f:GetWindowWidth())+", ",h="height="+(e>0?e:GetWindowHeight())+", ";a=a?a:0;var k="screenX="+a+", left="+a+", ";b=b?b:0;var l="screenY="+b+", top="+b,c=window.open(m,j,(d=="all"?g:d)+", "+i+h+k+l);if(c!=null)c.focus();return c};MtpsLoginStatus.ExpandOrCollapse=function(){for(var i=0;i<MtpsLoginStatus.ExpandOrCollapse.arguments.length;i++){var element=document.getElementById(MtpsLoginStatus.ExpandOrCollapse.arguments[i]);element.style.display=element.style.display=="none"?"block":"none";element.style.background=element.style.background==""?"url("+MtpsLoginStatus.OverlayImagePath+") repeat":""}}



function dolivesearch(sender){var o=document.getElementById(sender);if(o.className=="TextBoxSearch")document.getElementById("go").value="false";else{document.getElementById("go").value="true";if(typeof dcsMultiTrack=="function"){var dcsuri,dcssip,ti;dcsuri="results.aspx";dcssip="search.live.com";ti="_STO_SearchButton: Web";dcsMultiTrack("DCS.dcsuri",dcsuri,"DCS.dcssip",dcssip,"WT.ti",ti,"WT.dl","2","WT.z_srch_t","","DCS.dcsqry","","WT.ad","","WT.mc_id","");DCS.dcsuri=DCS.dcssip=DCS.dcsqry=WT.ti=WT.z_srch_t=""}}}



var control;(function($){$(".internav .normal").hover(function(){$(".Tab_Left",this).addClass("Tab_Left_Hovered");$(".Tab_Center",this).addClass("Tab_Center_Hovered");$(".Tab_Right",this).addClass("Tab_Right_Hovered")},function(){$(".Tab_Left",this).removeClass("Tab_Left_Hovered");$(".Tab_Center",this).removeClass("Tab_Center_Hovered");$(".Tab_Right",this).removeClass("Tab_Right_Hovered")})})(jQuery)



if(!window.Csp)window.Csp={};Csp.StringBuilder=function(value){this.strings=[];this.append(value)};Csp.StringBuilder.prototype={append:function(value){if(value)this.strings.push(value)},toString:function(){return this.strings.join("")}};Csp.Lsp=function(closeNormalImg,closeHoverImg,addNormalImg,addHoverImg,delayShow,delayHide,nextShow,repeatShow){this.closeNormalImage=closeNormalImg;this.closeHoverImage=closeHoverImg;this.addNormalImage=addNormalImg;this.addHoverImage=addHoverImg;this.delayShow=delayShow;this.delayHide=delayHide;this.nextShow=nextShow;this.repeatShow=repeatShow};Csp.Lsp.searchProviderUrl="/windows/csp.xml";Csp.Lsp.cookieStI="stI";Csp.Lsp.cookieStFI="stFI";Csp.Lsp.cookieStUA="stUA";Csp.Lsp.cookieEnabled=true;Csp.Lsp.startWidth=350;Csp.Lsp.startHeight=110;Csp.Lsp.startOpacity=.1;Csp.Lsp.widthChange=10;Csp.Lsp.heightChange=4;Csp.Lsp.opacityChange=.1;Csp.Lsp.width=423;Csp.Lsp.height=133;Csp.Lsp.opacity=1;Csp.Lsp.animationInterval=30;Csp.Lsp.prototype.closeTileTimerId;Csp.Lsp.prototype.openTileTimerId;Csp.Lsp.prototype.addButtonTimerId;Csp.Lsp.prototype.tempWidth=0;Csp.Lsp.prototype.tempHeight=0;Csp.Lsp.prototype.tempOpacity=0;Csp.Lsp.tileOpened=false;Csp.Lsp.prototype={setTileElementDisplay:function(e,display){var c=document.getElementById("lspClose");if(c)c.style.display=display;var a=document.getElementById("lspAdd");if(a)a.style.display=display;var d=document.getElementById("lspDontShow");if(d)d.style.display=display},openTile:function(e,autohide){if(this.hasValidNamedCookie(Csp.Lsp.cookieStUA,this.repeatShow)==true)return;var t=document.getElementById("lspTile");if(t){if(t.style.display=="none"){this.tempWidth=Csp.Lsp.startWidth;this.tempHeight=Csp.Lsp.startHeight;this.tempOpacity=Csp.Lsp.startOpacity;this.hideTicklerLink();this.setTileElementDisplay(e,"none");t.style.display="block"}if(document.all)t.filters.item("DXImageTransform.Microsoft.Alpha").opacity=Csp.Lsp.startOpacity*100;else t.style.MozOpacity=Csp.Lsp.startOpacity;if(Csp.Lsp.startWidth<=Csp.Lsp.width)t.style.width=Csp.Lsp.startWidth+"px";if(Csp.Lsp.startHeight<=Csp.Lsp.height)t.style.height=Csp.Lsp.startHeight+"px";Csp.Lsp.startWidth+=Csp.Lsp.widthChange;Csp.Lsp.startHeight+=Csp.Lsp.heightChange;Csp.Lsp.startOpacity+=Csp.Lsp.opacityChange;if(Csp.Lsp.startWidth>Csp.Lsp.width)Csp.Lsp.startWidth=Csp.Lsp.width;if(Csp.Lsp.startHeight>Csp.Lsp.height)Csp.Lsp.startHeight=Csp.Lsp.height;if(Csp.Lsp.startOpacity>Csp.Lsp.opacity)Csp.Lsp.startOpacity=Csp.Lsp.opacity;if(Csp.Lsp.startWidth!=Csp.Lsp.width||Csp.Lsp.startHeight!=Csp.Lsp.height||Csp.Lsp.startOpacity!=Csp.Lsp.opacity){var that=this;setTimeout(function(e){that.openTile(e,autohide)},Csp.Lsp.animationInterval)}if(Csp.Lsp.startWidth==Csp.Lsp.width&&Csp.Lsp.startHeight==Csp.Lsp.height&&Csp.Lsp.startOpacity==Csp.Lsp.opacity){Csp.Lsp.startWidth=this.tempWidth;Csp.Lsp.startHeight=this.tempHeight;Csp.Lsp.startOpacity=this.tempOpacity;this.tempWidth=Csp.Lsp.width;this.tempHeight=Csp.Lsp.height;this.tempOpacity=Csp.Lsp.opacity;this.setTileElementDisplay(e,"block");if(Csp.Lsp.tileOpened==false){t_omni_utils.omniModTracking(document.getElementById("lspLink"),"IE8 CPS","",teaserloc,0,"upgrade","");Csp.Lsp.tileOpened=true}if(this.nextShow>0){var d0=this.getExpirationDate(this.nextShow);this.setCookie(Csp.Lsp.cookieStI,d0,d0)}var _this=this;if(autohide)this.closeTileTimerId=setTimeout(function(e){_this.closeTile(e,true)},this.delayHide*1000)}}},closeTile:function(e,displayTicklerLink){var t=document.getElementById("lspTile");if(t){this.setTileElementDisplay(e,"none");if(Csp.Lsp.startWidth<=Csp.Lsp.width)t.style.width=Csp.Lsp.width+"px";if(Csp.Lsp.startHeight<=Csp.Lsp.height)t.style.height=Csp.Lsp.height+"px";if(document.all)t.filters.item("DXImageTransform.Microsoft.Alpha").opacity=Csp.Lsp.opacity*100;else t.style.MozOpacity=Csp.Lsp.opacity;Csp.Lsp.width-=Csp.Lsp.widthChange;Csp.Lsp.height-=Csp.Lsp.heightChange;Csp.Lsp.opacity-=Csp.Lsp.opacityChange;if(Csp.Lsp.width<=Csp.Lsp.startWidth)Csp.Lsp.width=Csp.Lsp.startWidth;if(Csp.Lsp.height<=Csp.Lsp.startHeight)Csp.Lsp.height=Csp.Lsp.startHeight;if(Csp.Lsp.opacity<=Csp.Lsp.startOpacity)Csp.Lsp.opacity=Csp.Lsp.startOpacity;if(Csp.Lsp.width!=Csp.Lsp.startWidth||Csp.Lsp.height!=Csp.Lsp.startHeight||Csp.Lsp.opacity!=Csp.Lsp.startOpacity){var _this=this;setTimeout(function(e){_this.closeTile(e,displayTicklerLink)},Csp.Lsp.animationInterval)}if(Csp.Lsp.width==Csp.Lsp.startWidth&&Csp.Lsp.height==Csp.Lsp.startHeight&&Csp.Lsp.opacity==Csp.Lsp.startOpacity){Csp.Lsp.width=this.tempWidth;Csp.Lsp.height=this.tempHeight;Csp.Lsp.opacity=this.tempOpacity;clearTimeout(this.closeTileTimerId);t.style.display="none";if(displayTicklerLink)this.showTicklerLink()}}},cancelCloseTile:function(){if(this.closeTileTimerId)clearTimeout(this.closeTileTimerId)},showTile:function(e){this.openTile(e,false);return false},hideTile:function(){var temp=document.getElementById("lspTile");if(temp)Csp.Lsp.hideDisplay(temp)},addEvent:function(oName,eName,fName){if(window.attachEvent)oName.attachEvent("on"+eName,fName);if(window.addEventListener)oName.addEventListener(eName,fName,false)},handleCloseMFEvents:function(e){if(!e)e=e?e:window.event?window.event:"";var elem=e&&e.srcElement?e.srcElement:e.target;if(e.type.toLowerCase()=="focus"||e.type.toLowerCase()=="blur"){var closeImg=elem.getElementsByTagName("img");if(closeImg&&closeImg.length==1)elem=closeImg[0]}if(e.type.toLowerCase()=="mouseover"||e.type.toLowerCase()=="focus")elem.src=this.closeHoverImage;else elem.src=this.closeNormalImage},handleCloseTile:function(e){this.closeTile(e,true)},setEvents:function(e){var c=document.getElementById("lspClose");if(c){this.addEvent(c,"click",Csp.Lsp.createDelegate(this,this.handleCloseTile));this.addEvent(c,"focus",Csp.Lsp.createDelegate(this,this.handleCloseMFEvents));this.addEvent(c,"blur",Csp.Lsp.createDelegate(this,this.handleCloseMFEvents));c.href="javascript:void(0);";var closeImg=c.getElementsByTagName("img");if(closeImg&&closeImg.length==1){this.addEvent(closeImg[0],"mouseover",Csp.Lsp.createDelegate(this,this.handleCloseMFEvents));this.addEvent(closeImg[0],"mouseout",Csp.Lsp.createDelegate(this,this.handleCloseMFEvents))}}var a=document.getElementById("lspAdd");if(a){var aAddBtn=a.getElementsByTagName("a");if(aAddBtn){this.addEvent(aAddBtn[0],"click",Csp.Lsp.createDelegate(this,this.handleAddClick));this.addEvent(aAddBtn[0],"focus",Csp.Lsp.createDelegate(this,this.handleAddMFEvents));this.addEvent(aAddBtn[0],"blur",Csp.Lsp.createDelegate(this,this.handleAddMFEvents));aAddBtn[0].href="javascript:void(0);";var aAddImg=aAddBtn[0].getElementsByTagName("img");if(aAddImg){this.addEvent(aAddImg[0],"mouseover",Csp.Lsp.createDelegate(this,this.handleAddMFEvents));this.addEvent(aAddImg[0],"mouseout",Csp.Lsp.createDelegate(this,this.handleAddMFEvents))}}}var d=document.getElementById("lspDontShow");if(d){var dLink=d.getElementsByTagName("a");if(dLink&&dLink.length==1){this.addEvent(dLink[0],"click",Csp.Lsp.createDelegate(this,this.handleDontShow));dLink[0].href="javascript:void(0);"}}var ticklerLink=document.getElementById("lspLinkText");if(ticklerLink){this.addEvent(ticklerLink,"click",Csp.Lsp.createDelegate(this,this.captureTicklerLinkClick));ticklerLink.href="javascript:void(0);"}var ticklerTile=document.getElementById("lspTile");if(ticklerTile)this.addEvent(ticklerTile,"mouseover",Csp.Lsp.createDelegate(this,this.cancelCloseTile))},handleAddMFEvents:function(e){if(!e)e=e?e:window.event?window.event:"";var elem=e&&e.srcElement?e.srcElement:e.target;if(elem){if(e.type.toLowerCase()=="focus"||e.type.toLowerCase()=="blur"){var aAddImg=elem.getElementsByTagName("img");if(aAddImg)elem=aAddImg[0]}if(e.type.toLowerCase()=="mouseover"||e.type.toLowerCase()=="focus")elem.src=this.addHoverImage;else elem.src=this.addNormalImage}},isSupportedBrowser:function(){return true},showTicklerLink:function(){var temp2=document.getElementById("lspLink");if(temp2)Csp.Lsp.showDisplay(temp2)},captureTicklerLinkClick:function(){var temp=document.getElementById("lspLink");clearTimeout(this.openTileTimerId);this.showTile()},hideTicklerLink:function(){var temp=document.getElementById("lspTile");if(temp)Csp.Lsp.hideDisplay(temp)},handleDontShow:function(e){if(this.repeatShow>0){var d1=this.getExpirationDate(this.repeatShow);this.setCookie(Csp.Lsp.cookieStUA,d1,d1)}this.closeTile(e,false);if(this.repeatShow>0)this.hideTicklerLink()},handleAddClick:function(e){t_omni_utils.omniModTracking(document.getElementById("lspLink"),"IE8 CPS","",teaserloc,1,"upgrade","");if(this.repeatShow>0){var d2=this.getExpirationDate(this.repeatShow);this.setCookie(Csp.Lsp.cookieStUA,d2,d2)}window.location=teaserloc;var that=this;this.addButtonTimerId=setTimeout(function(e){that.closeTile(e,false)},100);if(this.repeatShow>0)this.hideTicklerLink();return false},hasValidNamedCookie:function(name,showAgainDays){if(document.cookie.indexOf(name)==-1||showAgainDays==0)return false;if(document.cookie.indexOf(name)!=-1)return this.hasValidCookieValue(name,showAgainDays);return true},hasValidCookieValue:function(name,days){var cookieDate=this.getCookie(name),cookieMilliSec=Date.parse(cookieDate),currentDate=new Date;currentDate.setDate(currentDate.getDate()-days);var updatedDateInMilliSec=Date.parse(currentDate.toUTCString());if(updatedDateInMilliSec>cookieMilliSec)return false;return true},getCookie:function(name){var aCookie=document.cookie.split("; ");for(var i=0;i<aCookie.length;i++){var aCrumb=aCookie[i].split("=");if(name==aCrumb[0])return unescape(aCrumb[1])}return null},setCookie:function(name,value,date){if(Csp.Lsp.cookieEnabled){var domain=document.domain;if(domain&&domain!=null){domain=domain.toLowerCase();domain=domain.indexOf(".microsoft.com")!=-1?";domain=.microsoft.com":""}document.cookie=name+"="+escape(value)+";expires="+date+";path=/"+domain}},getExpirationDate:function(days){var d3=new Date;d3.setDate(d3.getDate()+days);return d3.toUTCString()},writeMetaTags:function(){if(this.isSupportedBrowser())if(this.hasValidNamedCookie(Csp.Lsp.cookieStUA,this.repeatShow)==false);},Render:function(){if(this.isSupportedBrowser()){if(this.hasValidNamedCookie(Csp.Lsp.cookieStUA,this.repeatShow)==false){this.setEvents();this.showTicklerLink()}else return;if(this.hasValidNamedCookie(Csp.Lsp.cookieStI,this.nextShow)==false){if(this.nextShow>0){var d4=this.getExpirationDate(this.nextShow);this.setCookie(Csp.Lsp.cookieStI,d4,d4)}if(this.delayHide>0)if(this.hasValidNamedCookie(Csp.Lsp.cookieStFI,this.repeatShow)==false){var d1=this.getExpirationDate(this.repeatShow);this.setCookie(Csp.Lsp.cookieStFI,d1,d1);var _that=this;this.openTileTimerId=setTimeout(function(e){_that.openTile(e,true)},this.delayShow*1000)}}}}};Csp.Lsp.createDelegate=function(instance,method){return function(){return method.apply(instance,arguments)}};Csp.Lsp.hideDisplay=function(obj){obj.style.display="none"};Csp.Lsp.showDisplay=function(obj){obj.style.display="block"};getSub=function(){var path=location.pathname;path=path.toLowerCase();if(path.indexOf("default.aspx")!=-1)path=path.substring(0,path.indexOf("default.aspx"));var sb=new Csp.StringBuilder;sb.append("/");var buildPath=path.split("/");buildPath.reverse();if(buildPath[2])sb.append(buildPath[2]);sb.append("/");if(buildPath[1])sb.append(buildPath[1]);path=sb.toString();return path};jQuery("#lnkDontshow").click(function(){var tickler=$(".Stotickler"),teaser=$(".StoTeaserHolder");$("#lspLink").css("background-image","none");$("#lspLink").css("display","none");tickler.animate({"height":"0px"},"fast");teaser.animate({"height":"0px"},"fast");$(".Stotickler").addClass("Stoteaserhidden");$(".StoTeaserHolder").addClass("Stoteaserhidden")})



function TFly_Init(name,offsetLeft,offsetTop,alignment,anyIter,anyTime,staticHover,popupHover,popupLatency,hideLatency,onInit,onPreAnimate,onPopup,onHide){var TFly=document.getElementById(name);TFly.alignment=alignment;TFly.DT=document.getElementById(name+"_Popup");TFly.F=document.getElementById(name+"_Anim");TFly.S=TFly.firstChild;TFly.oX=offsetLeft;TFly.oY=offsetTop;TFly.AnyIter=anyIter;TFly.AnyTime=anyTime;TFly.popupLatency=popupLatency;TFly.hideLatency=hideLatency;TFly.onPopup=onPopup;TFly.onPreAnimate=onPreAnimate;TFly.onHide=onHide;TFly.IsHover=false;TFly.InLoadingState=false;TFly.className_=TFly.className;TFly.DT.className_=TFly.DT.className;TFly.onmouseover=function(){TFly.IsHover=true;if(staticHover!="")TFly.className=staticHover;TFly_Popup(TFly,true)};TFly.onmouseout=function(){if(staticHover!="")TFly.className=TFly.className_;TFly_Popup(TFly,false);TFly.DT.blur();TFly.IsHover=false};if(document.all){TFly.onactivate=function(){if(!TFly.IsHover)TFly.onmouseover()};TFly.ondeactivate=function(){TFly.onmouseout()}}else{TFly.onfocus=function(){TFly.onmouseover()};TFly.onblur=function(){TFly.onmouseout()}}TFly.DT.onmouseover=function(){TFly.IsHover=true;if(popupHover!="")TFly.DT.className=popupHover;TFly_Popup(TFly,true)};TFly.DT.onmouseout=function(){if(popupHover!="")TFly.DT.className=TFly.DT.className_;TFly_Popup(TFly,false);TFly.IsHover=false};TFly_CallClientFunction(onInit,TFly)}function TFly_Reposition(TFly){var clientWidth=document.body.scrollWidth-20,width=TFly.DT.offsetWidth,absX=TFly.DT.offsetLeft,d=TFly.DT;while(d=d.offsetParent)absX+=d.offsetLeft;if(clientWidth<absX+width){var diff=clientWidth-absX-width;TFly.DT.style.left=TFly.DT.offsetLeft+diff+"px"}}function TFly_CallClientFunction(name,TFly){if(name!=null&&name!="")eval(name+"(TFly);")}function TFly_SetPosition(TFly,obj){obj.style.top=TFly.oY+TFly.offsetHeight+"px";obj.style.left=TFly.oX+(TFly.offsetWidth-obj.offsetWidth)*(1+TFly.alignment)/2+"px"}function TFly_Popup(TFly,value){if(TFly.onPreAnimate)TFly_CallClientFunction(TFly.onPreAnimate,TFly);if(TFly.timer!=null)window.clearTimeout(TFly.timer);if(value){if(TFly.status=="on")return;var timeout=TFly.status=="active"?0:TFly.popupLatency;if(TFly.AnyIter>0&&TFly.AnyTime>0)TFly.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,true,TFly.F.curIter)},timeout);else TFly.timer=window.setTimeout(function(){TFly_SetVisibility(TFly,true)},timeout)}else{if(TFly.status=="off")return;var timeout=TFly.status=="active"?0:TFly.hideLatency;if(TFly.AnyIter>0&&TFly.AnyTime>0)TFly.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,false,TFly.F.curIter)},timeout);else TFly.timer=window.setTimeout(function(){TFly_SetVisibility(TFly,false)},timeout)}}function TFly_SetVisibility(TFly,value){if(value==true){TFly_SetPosition(TFly,TFly.DT);TFly.style.zIndex="199";TFly_Reposition(TFly);TFly.S.style.position="absolute";TFly.S.style.position="";TFly.DT.style.visibility="visible"}else{TFly.DT.style.visibility="hidden";TFly.style.zIndex="198";TFly.S.style.position="absolute";TFly.S.style.position=""}}function TFly_AnimateStart(TFly,inout,curIter){if(TFly.F.timer!=null)window.clearTimeout(TFly.F.timer);if(curIter==null)curIter=0;if(TFly.status!="active"){TFly.status="active";TFly.F.style.visibility="visible";TFly.DT.style.visibility="hidden"}if(curIter<0||curIter>TFly.AnyIter){TFly.F.curIter=curIter<1?0:TFly.AnyIter;TFly.status=TFly.F.curIter==TFly.AnyIter?"on":"off";TFly.F.style.visibility="hidden";TFly_SetPosition(TFly,TFly.DT);TFly.style.zIndex=TFly.F.curIter==TFly.AnyIter?"999":"0";if(TFly.F.curIter==TFly.AnyIter){TFly.status="on";TFly_SetVisibility(TFly,true);TFly_CallClientFunction(TFly.onPopup,TFly)}else{TFly.status="off";TFly_SetVisibility(TFly,false);TFly_CallClientFunction(TFly.onHide,TFly)}}else{var per=curIter*(95/TFly.AnyIter)+5;TFly.F.style.visibility="hidden";TFly.F.style.width=TFly.DT.offsetWidth/100*per+"px";TFly.F.style.height=TFly.DT.offsetHeight/100*per+"px";TFly_SetPosition(TFly,TFly.F);TFly.F.style.visibility="visible";var timeout=per==100?0:TFly.AnyTime-TFly.AnyTime/TFly.AnyIter*curIter;curIter+=inout?1:-1;TFly.F.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,inout,curIter)},timeout);TFly.F.curIter=curIter}}

